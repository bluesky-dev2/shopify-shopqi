-use_javascripts 'controllers/emails'
%h2#title 邮件 &amp; 提醒
#action-links
  %ul
=render partial:"shared/noscript"
=render partial:"shared/upgrade_ie"
.pgroup
  %h3 编辑邮件模板
  %p.note 这些邮件会自动发送给您或者客户,您可以通过编辑以下的邮件模板
  %br/
  %ul#email-templates.clearfix
    -KeyValues::Mail::Type.all.each do |type|
      %li
        %a{:href => edit_email_path(emails.find_by_mail_type(type.code))}
          %strong=type.name
          %em=type.des
/ pgroup
.pgroup
  %h3 订单提醒
  %p.note.sb
    当有顾客下了新的订单时，您可以设置提醒的邮件地址。
  #order-notification-list
    %table#order-notification-table.data{:cellpadding => "0", :cellspacing => "0"}
      %tr
        %th{:colspan => "4", :style => "padding-left: 10px"} 当有顾客下单时：
      %tr#subscription-919172.order-subscription
        %td{:colspan => "2"}
          %span.note 发送邮件给:
          %strong &quot;development shop&quot; &lt;mahb45@gmail.com&gt;
        %td.r
          %a
            send test notification
        %td.r{:style => "width:25px"}
          %a{"data-method" => "delete", "data-remote" => "true", :href => "/admin/notifications/919172/unsubscribe?kind=OrderUserSubscription", :rel => "nofollow"}
            %img{:alt => "Trash", :src => "https://cdn.shopify.com/s/images/admin/icons/trash.gif?276001be6df6889f02aac5e423769ef9a8d5ed26"}/
      %tr#add-subscription
        %td.action-link{:colspan => "4"}
          %p#add-notify
            %span.plus +
            %a{:style => "display:inline"} 新增邮件提醒
      / end add-subscription
  / end order-notification-list
  #add-subscription-details{:style => "display:none"}
    %form{"accept-charset" => "UTF-8", :action => "/admin/notifications/subscribe", "data-remote" => "true", :method => "post"}
      %dl
        %dt 增加一个新的订单提醒
        %dd.sb
          %label{:for => "subscription-type"} 提  醒
          %select#subscription-type{:name => "subscribe"}
            %optgroup{:label => "提醒方式..."}
              %option{:value => "email"} 邮件地址&hellip;
            %optgroup{:label => "或者发送邮件给本店用户"}
              =options_for_select users.map{|u|[u.name,u.id]}
        %dd#email-detail.details.st.sb{:style => "display:none"}
          %label{:for => "address"} 邮件地址
          %input#address{:name => "address", :size => "30", :type => "text", :value => ""}/
        %dd#cellphone-detail.details.sb{:style => "display:none"}
          %p.sb
            %label{:for => "number"} 电话号码
            %input#number{:name => "number", :size => "15", :type => "text", :value => ""}/
          %p.note.st.sb
            The digit
            %strong 1
            is not required before your area code.
            %strong Your cell phone provider may charge you for incoming text messages, please check with your provider.
        %dd.sst.btn-divider.cl
          %input.btn{:name => "commit", :type => "submit", :value =>"保存" }
          or
          %a{:href => "#", :onclick => "Element.hide('add-subscription-details'); if($('order-notification-list').visible()){ Element.show('add-subscription'); } else { Element.show('add-subscription-btn')}; return false;"} Close

:javascript
  new App.Controllers.Emails()
